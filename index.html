<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Accueil ‚Äì CrossTraining Projet √âl√®ve + Fiche S√©curit√©</title>
<style>
:root{
  --green:#2ecc71; --blue:#3498db; --red:#e74c3c; --yellow:#f1c40f; --violet:#9b59b6;
  --bg:#f7f7fb; --card:#fff; --muted:#6b7280; --ink:#111827; --border:#e5e7eb;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:var(--bg);color:var(--ink)}
header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,#fff,rgba(255,255,255,.9));border-bottom:1px solid var(--border);backdrop-filter:blur(6px)}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
.h1{margin:0;font-size:1.45rem;font-weight:800}
.small{color:var(--muted);font-size:.92rem}
.toolbar{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.btn{appearance:none;border:1px solid transparent;background:var(--blue);color:#fff;padding:10px 14px;border-radius:14px;font-weight:650;cursor:pointer;box-shadow:0 6px 16px rgba(0,0,0,.06)}
.btn:hover{filter:brightness(1.05)}
.btn:active{transform:translateY(1px)}
.btn.green{background:var(--green)}
.btn.red{background:var(--red)}
.btn.yellow{background:var(--yellow);color:#111}
.btn.violet{background:var(--violet)}
.btn.outline{background:#fff;color:#111;border-color:var(--border)}
.panel{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;margin-top:16px}
.panel h2{margin:0 0 10px;font-size:1.08rem}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
@media (max-width:980px){.grid{grid-template-columns:repeat(6,1fr)}}
@media (max-width:680px){.grid{grid-template-columns:repeat(2,1fr)}}
label{color:var(--muted);font-size:.92rem}
input,select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#fff;font:inherit}
.card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:12px}
.badge{display:inline-block;font-size:.75rem;border-radius:999px;padding:4px 8px;border:1px solid var(--border);background:#fafafa;margin:2px}
.row{display:flex;gap:8px;flex-wrap:wrap}
.kit{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:900px){.kit{grid-template-columns:1fr}}
.table{width:100%;border-collapse:separate;border-spacing:0}
.table th,.table td{border:1px solid var(--border);padding:8px 10px}
.table th{background:#f8fafc;text-align:left}
.timerBox{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:start}
@media (max-width:720px){.timerBox{grid-template-columns:1fr}}
.timer{border:1px solid var(--border);border-radius:16px;padding:12px;background:#fff}
.timer .big{font-size:3rem;font-weight:900;text-align:center}
.timer .sub{color:var(--muted);text-align:center}
.blocks{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
@media (max-width:720px){.blocks{grid-template-columns:repeat(5,1fr)}}
.block{border:1px solid var(--border);border-radius:10px;padding:8px;text-align:center;background:#fff}
.block.active{border-color:#60a5fa;background:#eff6ff}
footer{margin:28px 0 60px;color:var(--muted);font-size:.85rem;text-align:center}

@media print{
  header,.noPrint{display:none!important}
  .panel{box-shadow:none}
}
</style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;align-items:flex-start;justify-content:space-between;gap:12px">
    <div>
      <div class="h1">Accueil ‚Äì CrossTraining Projet √âl√®ve</div>
      <div class="small">Saisie du nom, d√©marrage de la s√©ance, et fiche de s√©curit√©. Compatible ScanProf.</div>
    </div>
    <div class="toolbar noPrint">
      <button class="btn yellow" onclick="window.print()">üñ®Ô∏è Imprimer / PDF</button>
      <button class="btn violet" onclick="toggleHelp()">‚ùì Aide</button>
    </div>
  </div>
</header>

<main class="wrap">
  <!-- Identit√© & d√©marrage -->
  <section class="panel">
    <h2>Identit√© √©l√®ve & d√©marrage</h2>
    <div class="grid">
      <div style="grid-column:span 3"><label>Nom</label><input id="nom" placeholder="Nom"></div>
      <div style="grid-column:span 3"><label>Pr√©nom</label><input id="prenom" placeholder="Pr√©nom"></div>
      <div style="grid-column:span 3"><label>Classe</label><input id="classe" placeholder="2nde3"></div>
      <div style="grid-column:span 3"><label>Sexe</label><input id="sex" placeholder="F/M"></div>
      <div style="grid-column:span 12"><label>Titre du projet</label><input id="title" placeholder="Ex: Projet CrossTraining ‚Äì P√©riode 1"></div>
      <div style="grid-column:span 3"><label>Date</label><input id="date" type="date"></div>
      <div style="grid-column:span 3"><label>Cr√©neau</label><input id="slot" placeholder="12-13"></div>
      <div style="grid-column:span 6;align-self:end" class="row">
        <label style="display:flex;gap:8px;align-items:center"><input type="checkbox" id="ok"/> <span class="small">J'ai lu et je respecte la fiche de s√©curit√©</span></label>
        <button id="startBtn" class="btn green" onclick="start()" disabled>üöÄ Commencer</button>
      </div>
    </div>
  </section>

  <!-- Fiche S√©curit√© -->
  <section class="panel">
    <h2>Fiche de s√©curit√© (CrossTraining ‚Äì sans mat√©riel)</h2>
    <div class="kit">
      <div class="card">
        <h3 style="margin:0 0 6px">Mat√©riel & espace</h3>
        <ul class="small" style="margin:6px 0 0 18px">
          <li><strong>Aucun mat√©riel</strong> autre que <strong>chaises</strong> ou <strong>bancs</strong> <em>stables</em> et <em>intacts</em>.</li>
          <li>V√©rifier la <strong>stabilit√©</strong>, l'<strong>adh√©rence au sol</strong> et l'<strong>absence d'ar√™tes</strong> coupantes.</li>
          <li>Zone <strong>d√©gag√©e</strong> (‚âà 2 m) autour de chaque poste. Sol <strong>non glissant</strong>.</li>
          <li>Course sur une boucle <strong>d√©limit√©e</strong>, sens unique, <strong>sans croisement</strong>.</li>
        </ul>
        <div style="margin-top:8px" class="small">
          Exos autoris√©s sur banc/chaise : <span class="badge">Step-up contr√¥l√©</span> <span class="badge">Dips assis</span> <span class="badge">Squat √† poids du corps</span> <span class="badge">Pompes mains au banc</span> <span class="badge">Gainage</span>
        </div>
        <div class="small" style="margin-top:6px">
          Interdits : <span class="badge">Sauts depuis le banc</span> <span class="badge">Pieds sur dossier instable</span> <span class="badge">Tractions au banc</span> <span class="badge">Port√©s</span>
        </div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 6px">Conduite √† tenir</h3>
        <ul class="small" style="margin:6px 0 0 18px">
          <li><strong>√âchauffement 8‚Äì10 min</strong> : cardio l√©ger + mobilit√© (chevilles, hanches, √©paules).</li>
          <li><strong>Technique d'abord</strong> : amplitude contr√¥l√©e, gainage actif, respiration.</li>
          <li><strong>Intensit√© per√ßue</strong> vis√©e : 6‚Äì7/10, adapt√©e au niveau.</li>
          <li><strong>Hydratation</strong> √† proximit√© ; <strong>arr√™t imm√©diat</strong> si douleur vive, vertige, g√™ne respiratoire.</li>
          <li>Hygi√®ne : mains propres, essuyage des bancs/chaise apr√®s usage.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Protocole s√©ance demand√© -->
  <section class="panel">
    <h2>Protocole s√©ance</h2>
    <div class="card">
      <div class="row">
        <div class="badge">20 minutes</div>
        <div class="badge">10 blocs de 2' </div>
        <div class="badge">4 exercices + 1 course par bloc</div>
        <div class="badge">Temps restant = r√©cup√©ration</div>
      </div>
      <ol class="small" style="margin:8px 0 0 18px">
        <li>√Ä <strong>chaque d√©but de bloc</strong> (0:00, 2:00, 4:00, ‚Ä¶, 18:00) : encha√Æner <strong>4 exercices</strong> (choisis dans ton projet) puis <strong>une course</strong> (distance adapt√©e √† l'espace).</li>
        <li><strong>Cap de 2 minutes</strong> : si tout n'est pas termin√© ‚Üí s'arr√™ter au bip et passer au bloc suivant.</li>
        <li>Le <strong>temps restant</strong> dans les 2' = <strong>r√©cup√©ration</strong> active (marche, respiration).</li>
        <li>Au total : <strong>10 blocs</strong> cons√©cutifs = <strong>20 minutes</strong>.</li>
      </ol>
    </div>

    <div class="timerBox noPrint" style="margin-top:10px">
      <div class="timer">
        <div class="big" id="display">20:00</div>
        <div class="sub" id="phase">Pr√™t</div>
        <div class="row" style="justify-content:center;margin-top:8px">
          <button class="btn" onclick="startTimer()">‚ñ∂Ô∏è Start</button>
          <button class="btn outline" onclick="pauseTimer()">‚è∏Ô∏è Pause</button>
          <button class="btn red" onclick="resetTimer()">‚ü≤ Reset</button>
        </div>
      </div>
      <div class="timer">
        <div class="small" style="text-align:center;margin-bottom:6px">Blocs (2' chacun)</div>
        <div id="blocks" class="blocks"></div>
      </div>
    </div>
  </section>

  <footer>Accueil ‚Äì CrossTraining ‚Ä¢ √âquipe EPS Lyc√©e Vauban ‚Äì LUXEMBOURG ‚Äì JB</footer>
</main>

<!-- Aide -->
<dialog id="help"><div style="padding:16px;max-width:780px">
  <h3 style="margin:0 0 8px">Aide rapide</h3>
  <ol>
    <li>Renseigne ton <strong>Nom/Pr√©nom/Classe</strong> et <strong>coche</strong> la fiche s√©curit√©.</li>
    <li><strong>Commencer</strong> ouvre ¬´ Je con√ßois / Je r√©alise ¬ª ; ton identit√© est pr√©-remplie.</li>
    <li>Le <strong>timer 20'</strong> rythme les blocs : 2' par bloc (4 exos + course), r√©cup√©ration sur le temps restant.</li>
  </ol>
  <p class="small">La page ¬´ Je con√ßois / Je r√©alise ¬ª g√©n√®re un <strong>QR ScanProf</strong> avec objectifs, valeurs et points.</p>
  <div class="toolbar" style="justify-content:flex-end"><button class="btn outline" onclick="toggleHelp()">Fermer</button></div>
</div></dialog>

<script>
// ====== Utils ======
function $(id){ return document.getElementById(id) }
function todayISO(){ return new Date().toISOString().slice(0,10) }
function toggleHelp(){ const d=document.getElementById('help'); d.open? d.close(): d.showModal() }

// Prefill date
window.addEventListener('DOMContentLoaded',()=>{ $('date').value = todayISO(); buildBlocks(); bindEnable(); })

function bindEnable(){ ['nom','prenom','classe','ok'].forEach(id=>$(id).addEventListener('input',check)); }
function check(){ const ok = $('nom').value.trim() && $('prenom').value.trim() && $('classe').value.trim() && $('ok').checked; $('startBtn').disabled = !ok }

// Start ‚Üí save identity in localStorage for the student app
function start(){
  const identity = { nom:$('nom').value.trim(), prenom:$('prenom').value.trim(), classe:$('classe').value.trim(), sex:$('sex').value.trim(), title:$('title').value.trim(), date:$('date').value, slot:$('slot').value.trim() }
  const state = { identity, catalogue:[], plan:[], results:[] }
  localStorage.setItem('ct_student', JSON.stringify(state))
  // Redirect to the student page (ensure this filename exists in your repo)
  location.href = 'ct-eleve-concevoir-realiser.html'
}

// ====== 20' timer (10 x 2') ======
let tRemain = 20*60, tTimer=null
function updateDisplay(){ const m=Math.floor(tRemain/60).toString().padStart(2,'0'), s=(tRemain%60).toString().padStart(2,'0'); $('display').textContent=`${m}:${s}` }
function currentBlock(){ const elapsed = 20*60 - tRemain; return Math.min(9, Math.floor(elapsed/120)) }
function inBlockSec(){ const elapsed = 20*60 - tRemain; return elapsed % 120 }
function updatePhase(){ const sec = inBlockSec(); const phase = sec<120? (sec<110? 'Travail : 4 exos + course' : 'R√©cup√©ration') : '‚Äî'; $('phase').textContent = phase; highlightBlocks() }
function buildBlocks(){ const c=$('blocks'); c.innerHTML=''; for(let i=0;i<10;i++){ const d=document.createElement('div'); d.className='block'; d.id='b'+i; d.textContent=`Bloc ${i+1}`; c.appendChild(d) } highlightBlocks() }
function highlightBlocks(){ const idx=currentBlock(); for(let i=0;i<10;i++){ const d=$('b'+i); if(!d) continue; d.classList.toggle('active', i===idx) } }
function startTimer(){ if(tTimer) return; tTimer=setInterval(()=>{ tRemain=Math.max(0,tRemain-1); updateDisplay(); updatePhase(); if(tRemain===0){ pauseTimer(); $('phase').textContent='Termin√©' } },1000) }
function pauseTimer(){ if(tTimer){ clearInterval(tTimer); tTimer=null } }
function resetTimer(){ pauseTimer(); tRemain=20*60; updateDisplay(); $('phase').textContent='Pr√™t'; highlightBlocks() }
</script>
</body>
</html>
